<#
.SYNOPSIS
Simulates LogRhythm File Integrity Monitoring (FIM) activity for a user accessing sensitive files

.DESCRIPTION
Takes two arguments: -serverName, -loginName

.EXAMPLE
./C:\Windows\System32\WindowsPowershell\v1.0\powershell.exe -file FIM-Activity.ps1 -serverName "lrxm" -loginName "charles.lindbergh" 

.NOTES
April 2017 @chrismartin

.LINK
https://github.com/lrchma/Use-Case-Scripts

#>

param(
  [Parameter(Mandatory=$false)]
  [string]$loginName = 'charles.lindbergh',
  [Parameter(Mandatory=$false)]
  [string]$serverName = 'lrxm'
)

#Dot Source Variables - scripts need have the working directory as this path or they'll fail
. .\variables.ps1

#date format
$now = Get-Date -format 'MM d yyyy hh:mm:ss tt'

#prefix for log file, this is used in flat file path wildcard
$prefix = "fim"
[string]$random = get-random

$outputfile = $path + $prefix + $random + $extension


$logs = @(" ",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4240 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4240 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4240 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5904 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5904 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5904 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5904 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2108 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2108 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2108 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2108 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4392 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4392 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4392 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4392 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2680 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2680 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2680 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/22/2017 7:54:28 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2680 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=001 PERMS_DESC=Owner changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 OWNER=()->($servername\\administrator) CHANGESET=20170322171521-658462513 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1336 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=003 PERMS_DESC=Discretionary ACL changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 CHANGESET=20170322171521-658462513 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1336 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=002 PERMS_DESC=Group changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 GROUP=()->($servername\\Domain Users) CHANGESET=20170322171521-658462513 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1336 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=001 PERMS_DESC=Owner changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 OWNER=()->($servername\\administrator) CHANGESET=20170322171518-658461539 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2276 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=003 PERMS_DESC=Discretionary ACL changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 CHANGESET=20170322171518-658461539 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2276 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=002 PERMS_DESC=Group changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 GROUP=()->($servername\\Domain Users) CHANGESET=20170322171518-658461539 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2276 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=001 PERMS_DESC=Owner changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 OWNER=()->($servername\\administrator) CHANGESET=20170322171514-658460233 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1852 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=002 PERMS_DESC=Group changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 GROUP=()->($servername\\Domain Users) CHANGESET=20170322171514-658460233 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1852 Policy=HR1",
"REALTIME FILEMON EVENT=PERMS OBJECT=c:\\Windows\\PCHealth\\ERRORREP\\QSignoff PERMS_TYPE=003 PERMS_DESC=Discretionary ACL changed USER=$servername\\$loginname PROCESS=DW20.EXE SIZE=0 CHANGESET=20170322171514-658460233 DETAILS=lastaccess=3/16/2017 7:27:02 AM -0600 lastwrite=3/16/2017 7:19:26 AM -0600 create=2/25/2012 11:21:43 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1852 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\CreditCards.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=151552 SIZE=147919 DETAILS=lastaccess=3/22/2017 11:15:06 AM -0600 lastwrite=3/22/2017 11:15:06 AM -0600 create=10/10/2012 8:27:21 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4456 Policy=HR1",
"REALTIME FILEMON EVENT=MODIFY OBJECT=c:\\Test\\Corp_Secrets\\CreditCards.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=147949 SIZE=147949 DETAILS=lastaccess=3/22/2017 11:15:11 AM -0600 lastwrite=3/22/2017 11:15:11 AM -0600 create=10/10/2012 8:27:21 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4456 Policy=HR1 oldsize=147919 hash=(0xb9cda4101dde7ffc3d95316efb02532cc36352cb)->(0x7f2bb943a2f3606c591872c51e6a268f2ba1b329)",
"REALTIME FILEMON EVENT=MODIFY OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=254255 SIZE=254255 DETAILS=lastaccess=3/22/2017 11:15:07 AM -0600 lastwrite=3/22/2017 11:15:07 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1792 Policy=HR1 oldsize=254225 hash=(0xfd0fc73fe6cf674d82c95a341e34aa3d4cd359c2)->(0x4f71f58bac8cf7250e77662fbefc7839777b3255)",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=258048 SIZE=254225 DETAILS=lastaccess=3/22/2017 11:15:02 AM -0600 lastwrite=3/22/2017 11:15:02 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1792 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMReader.exe OFFSET=0 LENGTH=258048 SIZE=254225 DETAILS=lastaccess=3/22/2017 11:15:02 AM -0600 lastwrite=3/22/2017 11:15:02 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2772 Policy=HR1",
"REALTIME FILEMON EVENT=MODIFY OBJECT=c:\\Test\\Corp_Secrets\\CreditCards.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=147919 SIZE=147919 DETAILS=lastaccess=3/22/2017 11:15:06 AM -0600 lastwrite=3/22/2017 11:15:06 AM -0600 create=10/10/2012 8:27:21 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5860 Policy=HR1 oldsize=147889 hash=(0x262ee6b7f36dd1804521d52de20d4945a8111bb0)->(0xb9cda4101dde7ffc3d95316efb02532cc36352cb)",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\CreditCards.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=151552 SIZE=147889 DETAILS=lastaccess=3/22/2017 11:15:01 AM -0600 lastwrite=3/22/2017 11:15:01 AM -0600 create=10/10/2012 8:27:21 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5860 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=258048 SIZE=254195 DETAILS=lastaccess=3/22/2017 11:15:01 AM -0600 lastwrite=3/22/2017 11:15:01 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1984 Policy=HR1",
"REALTIME FILEMON EVENT=MODIFY OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=254225 SIZE=254225 DETAILS=lastaccess=3/22/2017 11:15:02 AM -0600 lastwrite=3/22/2017 11:15:02 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1984 Policy=HR1 oldsize=254195 hash=(0x15363a83601b2675df78531ad4f897fa26e46536)->(0xfd0fc73fe6cf674d82c95a341e34aa3d4cd359c2)",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMReader.exe OFFSET=0 LENGTH=258048 SIZE=254195 DETAILS=lastaccess=3/22/2017 11:15:01 AM -0600 lastwrite=3/22/2017 11:15:01 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2456 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\CreditCards.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=151552 SIZE=147859 DETAILS=lastaccess=3/21/2017 11:15:15 AM -0600 lastwrite=3/21/2017 11:15:15 AM -0600 create=10/10/2012 8:27:21 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5848 Policy=HR1",
"REALTIME FILEMON EVENT=MODIFY OBJECT=c:\\Test\\Corp_Secrets\\CreditCards.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=147889 SIZE=147889 DETAILS=lastaccess=3/22/2017 11:15:01 AM -0600 lastwrite=3/22/2017 11:15:01 AM -0600 create=10/10/2012 8:27:21 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5848 Policy=HR1 oldsize=147859 hash=(0x525cac1de1ac91bc86f5c86cd1032b236d68c6bb)->(0x262ee6b7f36dd1804521d52de20d4945a8111bb0)",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=258048 SIZE=254165 DETAILS=lastaccess=3/22/2017 8:27:01 AM -0600 lastwrite=3/22/2017 8:27:01 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=796 Policy=HR1",
"REALTIME FILEMON EVENT=MODIFY OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMModifier.exe OFFSET=0 LENGTH=254195 SIZE=254195 DETAILS=lastaccess=3/22/2017 11:15:01 AM -0600 lastwrite=3/22/2017 11:15:01 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=796 Policy=HR1 oldsize=254165 hash=(0x408908537de832bb3a1109d981ab8b2424689655)->(0x15363a83601b2675df78531ad4f897fa26e46536)",
"REALTIME FILEMON EVENT=READ OBJECT=c:\\Test\\Corp_Secrets\\customers.txt USER=$servername\\$loginname PROCESS=LRFIMReader.exe OFFSET=0 LENGTH=258048 SIZE=254165 DETAILS=lastaccess=3/22/2017 8:27:01 AM -0600 lastwrite=3/22/2017 8:27:01 AM -0600 create=8/7/2012 7:51:44 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2880 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=952 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=952 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=952 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=952 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1960 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1960 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1960 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1960 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4720 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4720 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4720 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4720 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=6100 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=6100 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=6100 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=6100 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4540 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4540 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4540 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=4540 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2196 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2196 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2196 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\confidentialccc.txt USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=25 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=2/1/2017 12:50:00 PM -0600 create=4/16/2014 2:21:33 AM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2196 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2096 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2096 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2096 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\FOUO spreadsheet.xml USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:24 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2096 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5728 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5728 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5728 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Top Secret Document.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=131072 SIZE=107520 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:41:35 AM -0600 create=10/2/2013 1:35:16 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=5728 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2612 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2612 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2612 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Intellectual Property.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=53248 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=9/11/2013 11:38:08 AM -0600 create=9/10/2013 12:22:03 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=2612 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1228 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1228 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1228 Policy=HR1",
"REALTIME FILEMON EVENT=READ OBJECT=C:\\Sensitive\\Executive Salaries.doc USER=$servername\\$loginname PROCESS=outlook.exe OFFSET=0 LENGTH=65536 SIZE=11971 DETAILS=lastaccess=3/21/2017 7:49:27 AM -0600 lastwrite=4/17/2015 10:20:40 AM -0600 create=9/10/2013 12:22:04 PM -0600 usersid=S-1-5-21-4140510078-396723217-1023477983-6166 pid=1228 Policy=HR1"

)

try{
    Foreach($log in $logs)
        {
           $log | Add-Content $outputfile
        }
    }catch{
            $ErrorMessage = $_.Exception.Message
            write-host $ErrorMessage 
    }





